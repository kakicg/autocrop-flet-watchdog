# メニューバー項目マニュアル

このドキュメントでは、商品撮影システムのメニューバー（右上のポップアップメニュー）に表示される各項目の機能と使い方を説明します。

## 目次

1. [モード関連](#モード関連)
2. [フォルダー設定](#フォルダー設定)
3. [画像処理設定](#画像処理設定)
4. [その他の機能](#その他の機能)

---

## モード関連

### テストモード切り替え

**機能説明：**
- テストモードのオン/オフを切り替えます。
- テストモードが有効な場合、通常処理の画像の隣にその処理に関連した白黒画像が表示されます。
- 通常モードとテストモードを交互に切り替えることができます。

**使用方法：**
1. メニューバーから「テストモード切り替え」を選択
2. テストモードが有効になると、サイドバーに「テストモード: 白黒画像を表示します」と表示されます
3. 再度選択すると、テストモードが無効になり通常モードに戻ります

**注意事項：**
- モードの状態は画面上部のモード表示で確認できます

---

### 実測値入力モード

**機能説明：**
- 実測値入力モードに切り替えると、指示に従って高さの異なる２つの商品の実際の高さと実写画像が入力できます。

**使用方法：**
1. メニューバーから「実測値入力モード」を選択。
2. 実測値入力モードに切り替わると、サイドバーに「1件目の商品の実測値を入力してください。」と表示されます。
3. サイドバーの入力欄に1件目の商品の実測高さ（cm単位）を入力してEnterキーを押します
4. 1件目の商品の写真を撮影します。
5. サイドバーに「2件目の商品の実測値を入力してください。」と表示されます。
6. サイドバーの入力欄に2件目の商品の実測高さ（cm単位）を入力してEnterキーを押します
7. 2件目の商品の写真を撮影します。
8. 全ての入力が終了すると通常のバーコード入力モードに切り替わります。

**注意事項：**
- 実測値入力モードでは、バーコード入力欄が非表示になり、実測値入力欄が表示されます
- モードの状態は画面上部のモード表示で確認できます

---

## フォルダー設定

### 監視フォルダーの設定

**機能説明：**
- 画像を監視するフォルダー（WATCH_DIR）を設定します。
- このフォルダーに新しい画像が追加されると、自動的に処理が開始されます。

**使用方法：**
1. メニューバーから「監視フォルダーの設定」を選択
2. サイドバーに監視フォルダー設定画面が表示されます
3. 「参照」ボタンをクリックして、監視したいフォルダーを選択します
4. パスを確認し、「更新」ボタンをクリックして設定を保存します
5. 「キャンセル」ボタンで設定をキャンセルできます

**注意事項：**
- 設定を変更した場合は、アプリケーションを再起動する必要があります
- 設定は`settings.json`ファイルに保存されます

---

### 書き込みフォルダーの設定

**機能説明：**
- 処理済み画像を保存するフォルダー（PROCESSED_DIR）を設定します。
- 処理された画像は、このフォルダー内の日付フォルダー（YYYYMMDD形式）に保存されます。

**使用方法：**
1. メニューバーから「書き込みフォルダーの設定」を選択
2. サイドバーに保存先ディレクトリ設定画面が表示されます
3. 「参照」ボタンをクリックして、保存先フォルダーを選択します
4. パスを確認し、「更新」ボタンをクリックして設定を保存します
5. 「キャンセル」ボタンで設定をキャンセルできます

**注意事項：**
- 設定を変更した場合は、アプリケーションを再起動する必要があります
- 設定は`settings.json`ファイルに保存されます
- 処理済み画像は、バーコード番号の先頭2桁でフォルダー分けされます

---

### プレビューフォルダーの設定

**機能説明：**
- プレビュー画像を保存するフォルダー（PREVIEW_DIR）を設定します。
- 処理前の画像が一時的に保存され、10日以上経過したファイルは自動的に削除されます。

**使用方法：**
1. メニューバーから「プレビューフォルダーの設定」を選択
2. サイドバーにプレビューフォルダー設定画面が表示されます
3. 「参照」ボタンをクリックして、プレビュー保存先フォルダーを選択します
4. パスを確認し、「更新」ボタンをクリックして設定を保存します
5. 「キャンセル」ボタンで設定をキャンセルできます

**注意事項：**
- 設定を変更した場合は、アプリケーションを再起動する必要があります
- 設定は`settings.json`ファイルに保存されます
- 10日以上経過したプレビュー画像は自動的に削除されます

---

## 画像処理設定

### GAMMA設定（コントラスト調整）

**機能説明：**
- 画像処理時のコントラスト調整値（GAMMA値）を設定します。
- GAMMA値は1.0から5.0の範囲で設定でき、0.1刻みで調整できます。
- 値が大きいほどコントラストが強くなります。

**使用方法：**
1. メニューバーから「GAMMA設定（コントラスト調整）」を選択
2. サイドバーにGAMMA設定画面が表示されます
3. スライダーを動かして、希望のGAMMA値を設定します
4. 値はリアルタイムで反映され、設定が保存されます
5. 「閉じる」ボタンで設定画面を閉じます

**注意事項：**
- デフォルト値は3.0です
- 設定は即座に反映され、次回の画像処理から適用されます
- 設定は`settings.json`ファイルに保存されます

---

### マージン設定

**機能説明：**
- 画像処理時の上下左右のマージン（余白）を設定します。
- 各方向について0%から50%の範囲で設定でき、0.1%刻みで調整できます。
- マージンを設定することで、商品の周囲に余白を確保できます。

**使用方法：**
1. メニューバーから「マージン設定」を選択
2. サイドバーにマージン設定画面が表示されます
3. 上・下・左・右それぞれのスライダーを動かして、希望のマージン値を設定します
4. 値はリアルタイムで反映され、設定が保存されます
5. 「閉じる」ボタンで設定画面を閉じます

**注意事項：**
- デフォルト値は各方向5.0%です
- 設定は即座に反映され、次回の画像処理から適用されます
- 設定は`settings.json`ファイルに保存されます

---

### 縦横比設定

**機能説明：**
- 処理後の画像の縦横比を設定します。
- 4:3（縦4横3）、3:2（縦3横2）、1:1（正方形）から選択できます。

**使用方法：**
1. メニューバーから「縦横比設定」を選択
2. サイドバーに縦横比設定画面が表示されます
3. 希望の縦横比のラジオボタンを選択します
4. 選択は即座に反映され、設定が保存されます
5. 「閉じる」ボタンで設定画面を閉じます

**注意事項：**
- デフォルト値は「4:3」です
- 設定は即座に反映され、次回の画像処理から適用されます
- 設定は`settings.json`ファイルに保存されます

---

## その他の機能

### 累計撮影枚数をリセット

**機能説明：**
- 画面上部に表示されている累計撮影枚数を0にリセットします。
- 同時に、起算日も現在の日付に更新されます。

**使用方法：**
1. メニューバーから「累計撮影枚数をリセット」を選択
2. 累計撮影枚数が0にリセットされ、起算日が更新されます
3. サイドバーに「累計撮影枚数をリセットしました。」と表示されます

**注意事項：**
- リセット操作は取り消せません
- リセット後は、新しい起算日から撮影枚数がカウントされます

---

### システム終了

**機能説明：**
- アプリケーションを安全に終了します。
- フォルダー監視プロセスも停止し、すべてのリソースを解放します。

**使用方法：**
1. メニューバーから「システム終了」を選択
2. アプリケーションが終了します

**注意事項：**
- 処理中の画像がある場合は、処理が完了してから終了します
- 未保存の設定は自動的に保存されます

---

## メニューバーの表示/非表示

メニューバー自体の表示/非表示を切り替えることができます。

**使用方法：**
- サイドバーのバーコード入力欄に「m」と入力してEnterキーを押すと、メニューバーの表示/非表示が切り替わります
- 表示時は緑色のメッセージ、非表示時は黄色のメッセージが表示されます
- 設定は`settings.json`ファイルに保存され、次回起動時も反映されます

---

## 補足情報

- すべての設定は`settings.json`ファイルに保存されます
- フォルダー設定を変更した場合は、アプリケーションの再起動が必要です
- 画像処理設定（GAMMA、マージン、縦横比）は即座に反映されます
- メニューバーが表示されていない場合は、バーコード入力欄に「m」と入力して表示を復元できます

