# 商品撮影システム

## 概要
このアプリケーションは、商品の撮影と画像処理を自動化するシステムです。Watchdogを使用して指定フォルダを監視し、新しく追加された画像に対して自動的に処理を行います。

## 機能
- フォルダ監視による自動画像処理
- バーコード情報に基づく画像管理
- 2つの撮影モード
  - 単一角度モード（デフォルト）
  - 複数角度モード
- 画像の自動トリミングと高さ推定
- 処理済み画像のデータベース管理

## ファイル構成と役割

### メインアプリケーション関連
- `main.py`
  - アプリケーションのエントリーポイント
  - Fletアプリケーションの初期化
  - メニューバーとモード切り替えの実装
  - Watchdogプロセスの起動
  - 他のコンポーネントの統合

### UIコンポーネント
- `sidebar.py`
  - サイドバーのUI実装
  - バーコード入力の処理
  - モードに応じたUI表示の切り替え
  - メインビューとの連携

- `mainview.py`
  - メインビューのUI実装
  - 処理済み画像の表示
  - スクロール機能の実装

### データ処理関連
- `watchdog_process.py`
  - フォルダ監視の実装
  - 画像処理のトリガー
  - バーコード情報の管理
  - モードに応じた処理の分岐
  - メインビューへの画像表示

- `image_processing.py`
  - 画像処理の実装
  - 高さ推定
  - 画像の保存

- `item_db.py`
  - データベース操作
  - 処理済み画像情報の保存
  - SQLAlchemyを使用したDB管理

### ユーティリティ
- `jtext.py`
  - 日本語テキスト処理のユーティリティ

## データフロー

### 1. ユーザー入力
```
sidebar.py (バーコード入力)
→ main.py (セッション管理)
→ watchdog_process.py (バーコード情報の保持)
```

### 2. 画像処理
```
watchdog_process.py (フォルダ監視)
→ image_processing.py (画像処理)
→ item_db.py (データ保存)
→ mainview.py (表示更新)
```

### 3. モード管理
```
main.py (モード切り替え)
→ sidebar.py (UI表示の変更)
→ watchdog_process.py (処理ロジックの変更)
```

## 使用方法
1. アプリケーションを起動
2. デフォルトで単一角度モードが有効
3. バーコードを入力（オプション）
4. `./watch_folder`に画像を追加
5. 自動的に画像処理が実行され、結果が表示される

## 依存関係
- flet
- watchdog
- opencv-python
- SQLAlchemy
- その他必要なPythonパッケージ

## 注意事項
- 画像は`./watch_folder`に配置してください
- 処理済み画像は`./processed_images`に保存されます
- データベースは`product_data.db`に保存されます
